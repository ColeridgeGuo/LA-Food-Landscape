<!DOCTYPE html>
<html>
	<head>
		<title>LA Food Landscape with jQuery</title>
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <script src="jquery-3.3.1.js"></script>
		<meta charset="utf-8">
		<style>
      #header {
        float: top;
				height: 10%;
			}
			#map {
        height: 85%;
        width: 80%;
        padding: 20px;
			}
			#filter {
				float: left;
        margin: 20px;
			}
      #filterList {
        list-style-type: none;
        margin: 0; /* To remove default bottom margin */
        padding: 0; /* To remove default left padding */
      }
			html, body {
				height: 95%;
			}
		</style>
	</head>

	<body>

		<div id="header">
			<h1>LA Food Landscape</h1>
		</div>

		<div id="filter">
      <h2>Food Categories</h2>
			<ul id="filterList">
        <li><input type="checkbox" name="filter" id="HR" >Healthy Restaurants</li>
        <li><input type="checkbox" name="filter" id="UH" >Unhealthy Restaurants</li>
				<li><input type="checkbox" name="filter" id="VR" >Vegan Restaurants</li>
				<li><input type="checkbox" name="filter" id="SM" >Supermarkets</li>
				<li><input type="checkbox" name="filter" id="GS" >Grocery Stores</li>
        <li><input type="checkbox" name="filter" id="OT" >Others</li>
			</ul>
		</div>

		<div id="map"></div>

		<script>
      var map;
      var markers = [];

      // start out with filter features set to false, so no filtering happens by default
      var filters = {Description:null};

      $(function () {
        $('input[name=filter]').change(function (e) {
          map_filter(this.id);
          filter_markers()
        });
      });

      // after the geojson is loaded, iterate through the map data to create markers
      function loadMarkers() {
        console.log('creating markers');
        geojson_url = 'GeoJSON_data/fake_data.geojson';
        $.getJSON(geojson_url, function(result) {
          // Post select to url.
          data = result['features'];
          $.each(data, function(key, val) {
            var point = new google.maps.LatLng(
              parseFloat(val['geometry']['coordinates'][1]),
              parseFloat(val['geometry']['coordinates'][0]));
            var title = val['properties']['Name'];
            var marker = new google.maps.Marker({
              position: point,
              title: title,
              map: map,
              properties: val['properties']
            });
            markers.push(marker);
          });
        });
      }

      function initMap() {
        console.log('initializing map');
        var map_center = new google.maps.LatLng(34.039435,-118.246928);
        var map_options = {
          zoom: 10,
          center: map_center
        };

        var map_document = document.getElementById('map');
        map = new google.maps.Map(map_document, map_options);

        loadMarkers();
      }

    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyABK3DsKer5m90lhENpsR-16mWZ5D-2NNA&libraries=places&callback=initMap"
            async defer></script>
	</body>
</html>