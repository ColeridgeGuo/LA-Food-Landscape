<!DOCTYPE html>
<html>
	<head>
		<title>LA Food Landscape</title>
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
		<script src="jquery-3.3.1.js"></script>
		<meta charset="utf-8">
		<style>
      #header {
        float: top;
        height: 10%;
      }
      #map {
        height: 85%;
        width: 60%;
        padding: 20px;
      }
      #filter_div {
        float: left;
        margin: 20px;
        overflow: scroll;
      }
      html, body {
        height: 95%;
      }
		</style>
	</head>

	<body>

		<div id="header">
			<h1>LA Food Landscape</h1>
		</div>

		<div id="filter_div">
			<h2>Food Categories</h2>

      <input type="checkbox" onclick="clickBox(this,'CERTIFIED FARMERS\' MARKET (1-20) VENDORS')"
             id="CERTIFIED FARMERS' MARKET (1-20) VENDORS" >
      CERTIFIED FARMERS' MARKET (1-20) VENDORS<br>

      <input type="checkbox" onclick="clickBox(this,'CERTIFIED FARMERS\' MARKET (21 + ) VENDORS')"
             id="CERTIFIED FARMERS' MARKET (21 + ) VENDORS" >
      CERTIFIED FARMERS' MARKET (21 + ) VENDORS<br>

      <input type="checkbox" onclick="clickBox(this,'FOOD MKT RETAIL (2,000+ SF) HIGH RISK')"
             id="FOOD MKT RETAIL (2,000+ SF) HIGH RISK" >
      FOOD MKT RETAIL (2,000+ SF) HIGH RISK<br>

      <input type="checkbox" onclick="clickBox(this,'FOOD MKT RETAIL (2,000+ SF) LOW RISK')"
             id="FOOD MKT RETAIL (2,000+ SF) LOW RISK" >
      FOOD MKT RETAIL (2,000+ SF) LOW RISK<br>

      <input type="checkbox" onclick="clickBox(this,'FOOD MKT RETAIL (2,000+ SF) MODERATE RISK')"
             id="FOOD MKT RETAIL (2,000+ SF) MODERATE RISK" >
      FOOD MKT RETAIL (2,000+ SF) MODERATE RISK<br>

      <input type="checkbox" onclick="clickBox(this,'FOOD MKT RETAIL (25-1,999 SF) HIGH RISK')"
             id="FOOD MKT RETAIL (25-1,999 SF) HIGH RISK" >
      FOOD MKT RETAIL (25-1,999 SF) HIGH RISK<br>

      <input type="checkbox" onclick="clickBox(this,'FOOD MKT RETAIL (2,000+ SF) LOW RISK')"
             id="FOOD MKT RETAIL (25-1,999 SF) LOW RISK" >
      FOOD MKT RETAIL (25-1,999 SF) LOW RISK<br>

      <input type="checkbox" onclick="clickBox(this,'FOOD MKT RETAIL (25-1,999 SF) MODERATE RISK')"
             id="FOOD MKT RETAIL (25-1,999 SF) MODERATE RISK" >
      FOOD MKT RETAIL (25-1,999 SF) MODERATE RISK<br>

      <input type="checkbox" onclick="clickBox(this,'RESTAURANT (0-30) SEATS HIGH RISK')"
             id="RESTAURANT (0-30) SEATS HIGH RISK" >
      RESTAURANT (0-30) SEATS HIGH RISK<br>

      <input type="checkbox" onclick="clickBox(this,'RESTAURANT (0-30) SEATS LOW RISK')"
             id="RESTAURANT (0-30) SEATS LOW RISK" >
      RESTAURANT (0-30) SEATS LOW RISK<br>

      <input type="checkbox" onclick="clickBox(this,'RESTAURANT (0-30) SEATS MODERATE RISK')"
             id="RESTAURANT (0-30) SEATS MODERATE RISK" >
      RESTAURANT (0-30) SEATS MODERATE RISK<br>

      <input type="checkbox" onclick="clickBox(this,'RESTAURANT (151 + ) SEATS HIGH RISK')"
             id="RESTAURANT (151 + ) SEATS HIGH RISK" >
      RESTAURANT (151 + ) SEATS HIGH RISK<br>

      <input type="checkbox" onclick="clickBox(this,'RESTAURANT (151 + ) SEATS LOW RISK')"
             id="RESTAURANT (151 + ) SEATS LOW RISK" >
      RESTAURANT (151 + ) SEATS LOW RISK<br>

      <input type="checkbox" onclick="clickBox(this,'RESTAURANT (151 + ) SEATS MODERATE RISK')"
             id="RESTAURANT (151 + ) SEATS MODERATE RISK" >
      RESTAURANT (151 + ) SEATS MODERATE RISK<br>

      <input type="checkbox" onclick="clickBox(this,'RESTAURANT (31-60) SEATS HIGH RISK')"
             id="RESTAURANT (31-60) SEATS HIGH RISK" >
      RESTAURANT (31-60) SEATS HIGH RISK<br>

      <input type="checkbox" onclick="clickBox(this,'RESTAURANT (31-60) SEATS LOW RISK')"
             id="RESTAURANT (31-60) SEATS LOW RISK" >
      RESTAURANT (31-60) SEATS LOW RISK<br>

      <input type="checkbox" onclick="clickBox(this,'RESTAURANT (31-60) SEATS MODERATE RISK')"
             id="RESTAURANT (31-60) SEATS MODERATE RISK" >
      RESTAURANT (31-60) SEATS MODERATE RISK<br>

      <input type="checkbox" onclick="clickBox(this,'RESTAURANT (61-150) SEATS HIGH RISK')"
             id="RESTAURANT (61-150) SEATS HIGH RISK" >
      RESTAURANT (61-150) SEATS HIGH RISK<br>

      <input type="checkbox" onclick="clickBox(this,'RESTAURANT (61-150) SEATS LOW RISK')"
             id="RESTAURANT (61-150) SEATS LOW RISK" >
      RESTAURANT (61-150) SEATS LOW RISK<br>

      <input type="checkbox" onclick="clickBox(this,'RESTAURANT (61-150) SEATS MODERATE RISK')"
             id="RESTAURANT (61-150) SEATS MODERATE RISK" >
      RESTAURANT (61-150) SEATS MODERATE RISK<br>

		</div>

		<div id="map"></div>

		<script>
      var map;
      var markers = [];

      // Create the marker and push it to the markers array
      function createMarker(latlng,name,category) {

        // Create the marker
        var marker = new google.maps.Marker({
          position: latlng,
          map: map,
          title: name,
        });

        // Store the category and name info as a marker properties
        marker.mycategory = category;
        marker.myname = name;

        markers.push(marker);
      } // end createMarker

      // Show all markers of a particular category
      function showMarkers(category) {
        for (var i=0; i<markers.length; i++) {
          if (markers[i].mycategory === category) {
            markers[i].setVisible(true);
          }
        }
        // check the checkbox
        document.getElementById(category).checked = true;
      }

      // Hide all markers of a particular category
      function hideMarkers(category) {
        for (var i=0; i<markers.length; i++) {
          if (markers[i].mycategory === category) {
            markers[i].setVisible(false);
          }
        }
        // clear the checkbox
        document.getElementById(category).checked = false;
      }

      // When a checkbox is checked, show the markers of its category;
      // when a checkbox is unchecked, hide the markers of that category
      function clickBox(box,category) {
        if (box.checked) {
          showMarkers(category);
        } else {
          hideMarkers(category);
        }
      }

      // Initialize the map and the markers
      function initMap() {
        console.log('initializing map');
        var map_center = new google.maps.LatLng(34.039435,-118.246928);
        var map_options = {
          zoom: 10,
          center: map_center
        };
        var map_document = document.getElementById('map');
        map = new google.maps.Map(map_document, map_options);

        $(document).ready(function(){
          $.getJSON('real_data.json', function(data) {
            for (var i = 0; i < data.length; i++) {
              // obtain the attributes of each marker
              var item = data[i];
              var point = new google.maps.LatLng(item.LATITUDE, item.LONGITUDE);
              var name = item.FACILITY_NAME;
              var category = item.PE_DESCRIPTION;
              // create the marker
              var marker = createMarker(point,name,category);
            }

            // hide and show some markers initially
            showMarkers("CERTIFIED FARMERS' MARKET (1-20) VENDORS");
            hideMarkers("CERTIFIED FARMERS' MARKET (21 + ) VENDORS");
            hideMarkers("FOOD MKT RETAIL (2,000+ SF) HIGH RISK");
            hideMarkers("FOOD MKT RETAIL (2,000+ SF) LOW RISK");
            hideMarkers("FOOD MKT RETAIL (2,000+ SF) MODERATE RISK");
            hideMarkers("FOOD MKT RETAIL (25-1,999 SF) HIGH RISK");
            hideMarkers("FOOD MKT RETAIL (25-1,999 SF) LOW RISK");
            hideMarkers("FOOD MKT RETAIL (25-1,999 SF) MODERATE RISK");
            hideMarkers("RESTAURANT (0-30) SEATS HIGH RISK");
            hideMarkers("RESTAURANT (0-30) SEATS LOW RISK");
            hideMarkers("RESTAURANT (0-30) SEATS MODERATE RISK");
            hideMarkers("RESTAURANT (151 + ) SEATS HIGH RISK");
            hideMarkers("RESTAURANT (151 + ) SEATS LOW RISK");
            hideMarkers("RESTAURANT (151 + ) SEATS MODERATE RISK");
            hideMarkers("RESTAURANT (31-60) SEATS HIGH RISK");
            hideMarkers("RESTAURANT (31-60) SEATS LOW RISK");
            hideMarkers("RESTAURANT (31-60) SEATS MODERATE RISK");
            hideMarkers("RESTAURANT (61-150) SEATS HIGH RISK");
            hideMarkers("RESTAURANT (61-150) SEATS LOW RISK");
            hideMarkers("RESTAURANT (61-150) SEATS MODERATE RISK");

          });
        });
      }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyABK3DsKer5m90lhENpsR-16mWZ5D-2NNA&libraries=places&callback=initMap"
            async defer></script>
	</body>
</html>